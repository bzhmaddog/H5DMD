<!DOCTYPE html>
<html>
    <head>
        <meta httpEquiv="origin-trial" content="AjmbVK5jmmfoO2lgbG0tNNQ52Kb2nrkT5oFntPiNoHO1QbNeSQ1sC/H2hAGWfDSr7IhxbIMrIOKP7BxGbXWtzwYAAABTeyJvcmlnaW4iOiJodHRwczovL2J6aG1hZGRvZy5naXRodWIuaW86NDQzIiwiZmVhdHVyZSI6IldlYkdQVSIsImV4cGlyeSI6MTY2MzcxODM5OX0=" />

        <style>
            * {
	            box-sizing: border-box;
            }
            body {
                background:  black;
                padding: 0;
                margin: 0;
                overflow: hidden;
            }

            label {
                color: white;
            }

            /*#output {
                border: 1px solid red;
            }*/
        </style>
    </head>
    <body>
        <canvas id="output" width="1280" height="390"></canvas>
        <br />
        <div id="checkboxes">
            <div>
                <input id="background_checkbox" type="checkbox" data-layer="bg" checked />
                <label for="background_checkbox">Background</label>
            </div>
            <div>
                <input id="sprite_checkbox" type="checkbox" data-layer="sprite" checked />
                <label for="sprite_checkbox">Sprite</label>
            </div>
            <div>
                <input id="animation_checkbox" type="checkbox" data-layer="animation" checked />
                <label for="animation_checkbox">background animation</label>
            </div>
            <div>
                <input id="vstext_checkbox" type="checkbox" data-layer="text2" checked />
                <label for="vstext_checkbox">VS text inner</label>
            </div>
            <div>
                <input id="vstext_checkbox2" type="checkbox" data-layer="text3" checked />
                <label for="vstext_checkbox2">VS text outer</label>
            </div>
            <div>
                <input id="scotttext_checkbox" type="checkbox" data-layer="text1" checked/>
                <label for="scotttext_checkbox">Scott pilgrim text</label>
            </div>
            <div>
                <input id="matthewtext_checkbox" type="checkbox" data-layer="text4" checked />
                <label for="matthewtext_checkbox">Matthew Patel text</label>
            </div>
            <div>
                <input id="matthewimg_checkbox" type="checkbox" data-layer="canvas" checked />
                <label for="matthewimg_checkbox">Matthew Patel Image</label>
            </div>
        </div>
        <script type="module">
			import { DMD } from "./js/DMD.js";
			import { Colors } from "./js/Colors.js";
			import { DotShape } from "./js/renderers/DMDRenderer.js";
			import { Options } from "./js/Options.js";
		
            (function () {
                'use strict';
				
				//window.Options = Options;
				

                // When dom is loaded create the objects and bind the events
                document.addEventListener('DOMContentLoaded', function () {

                    var output = document.getElementById('output');


                    // 256x78
                    //var dmd = new DMD(output, 4, 1, 1, 1, DMD.DotShape.Square, 14, 1, true);

                    // 426x130
                    var dmd = new DMD(output, 2, 1, 1, 1, DotShape.Square, 14, 1, true);
					//var dmd = new DMD(output, 2, 1, 1, 1, DMD.DotShape.Square, 14, 1, true);

                    // 320x97
                    //var dmd = new DMD(output, 2, 2, 1, 1, DMD.DotShape.Square, 14, 1, true);

                    // 128x39
                    //var dmd = new DMD(output, 7, 3, 1, 1, DMD.DotShape.Square, 14, 1, true);

                    window.dmd = dmd;

                    			// Init DMD then
        			dmd.init().then( () => {
                        // Start rendering dmd
                        dmd.run();
						
						var textLayer4 = dmd.createTextLayer('text4', {
                            'text' : "Matthew Patel",
                            align : 'center',
                            vAlign : 'middle',
                            fontSize : 30,
                            hOffset : -1,
							//antialiasing: false,
							outlineWidth: 2,
							outlineColor: Colors.Red
                        });
						
                        /*dmd.createLayer(DMD.LayerType.Image, 'bg', {
                            src : 'images/boss-mode-bg.png',
                            //opacity : 0.1
                        });*/

                        /*dmd.createAnimationLayer('animation', {
                            images : [
                                '/resources/animations/boss-mode/0.webp',
                                '/resources/animations/boss-mode/1.webp',
                                '/resources/animations/boss-mode/2.webp',
                                '/resources/animations/boss-mode/3.webp',
                                '/resources/animations/boss-mode/4.webp',
                                '/resources/animations/boss-mode/5.webp',
                                '/resources/animations/boss-mode/6.webp',
                                '/resources/animations/boss-mode/7.webp',
                                '/resources/animations/boss-mode/8.webp',
                                '/resources/animations/boss-mode/9.webp',
                                '/resources/animations/boss-mode/10.webp',
                                '/resources/animations/boss-mode/11.webp',
                                '/resources/animations/boss-mode/12.webp',
                                '/resources/animations/boss-mode/13.webp',
                                '/resources/animations/boss-mode/14.webp'
                            ],
                            duration : 800,
                            autoplay : true,
                            loop : true
                        });*/

                        /*var canvasLayer = dmd.createCanvasLayer('canvas', {}, function() {
                            var img = new Image();
							
							console.log('Canvas layer loaded');

		                    img.onload = function() {
                                // x,y coordinate are related to the screen width/height (not dmd width/height) to be consistant depending on the settings used
			                    canvasLayer.drawImage(
                                    img,
                                    {
                                        align: 'right',
                                        vAlign : 'middle',
                                        height : '80%'
                                    }
                                );
		                    }

                            img.src = 'resources/images/boss-matthew-big.png';
                        });*/
						
						/*var videoLayer = dmd.createVideoLayer('video', {
							src : 'resources/videos/earth.webm',
							autoplay : true,
							width : 231,
							height : 130,
							loop : true
						}, function(){
						});*/

                        /*var textLayer1 = dmd.createTextLayer('text1', {
                            'text' : "Scott Pilgrim",
                            left : '0',
                            top : 0,
                            fontSize : 10
                        });*/

                        /*var textLayer2 = dmd.createLayer(DMD.LayerType.Text, 'text2', {
                            'text' : "VS",
                            align : 'center',
                            vAlign : 'middle',
                            fontFamily : 'Arial',
                            fontSize : 40,
                            fontStyle : 'italic bold',
                            color : '#FFFFFF80', // RGBA
                            hOffset : '-15%'
                        });*/

                        /*var textLayer3 = dmd.createLayer(DMD.LayerType.Text, 'text3', {
                            'text' : "VS",
                            align : 'center',
                            vAlign : 'middle',
                            fontFamily : 'Arial',
                            fontSize : 40,
                            fontStyle : 'italic bold',
                            color : '#00000000', // totally transparent
                            strokeWidth : 2,
                            strokeColor : Colors.red,
                            hOffset : '-15%'
                        });*/

                        /*var textLayer4 = dmd.createLayer(DMD.LayerType.Text, 'text4', {
                            'text' : "Matthew Patel",
                            align : 'right',
                            vAlign : 'bottom',                            
                            fontSize : 10,
                            hOffset : -1
                        });*/

                        /*var spriteLayer = dmd.createSpriteLayer('sprite', {}, function() {
                            spriteLayer.createSprite(
                                'scott',
                                '/resources/sprites/scott2x.png',
                                6,
                                0,
                                [
                                    ['idle', 8, 72, 118, 0, 0, 900], //800
                                    ['walk', 6, 72, 126, 0, 118, 1100],
                                    ['run', 8, 106, 120, 0, 244, 650],
                                    ['idle2', 4, 92, 124, 0, 364, 900],
                                    ['taunt', 9, 92, 124, 0, 488, 450]
                                ],
                                '2%',
                                '2%'
                            ).then(() => {
                                let seq = [
                                            ['idle' , 3],
                                            ['walk' , 5],
                                            ['run', 4],
                                            ['taunt', 1]
                                            //['idle2', 1]
                                        ];

                                spriteLayer.enqueueSequence('scott', seq, true);
                                spriteLayer.run('scott');
                            });
                        });*/                   
                        
                        //var checkboxElems = document.querySelectorAll("input[type='checkbox']");


                        /*for (var i = 0; i < checkboxElems.length; i++) {
                            checkboxElems[i].addEventListener("click", function(element) {
                                var layerName = element.target.dataset.layer;
                                var visible = element.target.checked
                                var layer = dmd.getLayer(layerName);

                                if (layer != null) {
                                    layer.setVisibility(visible);

                                    if (visible) {
                                        if (layerName === "sprite") {
                                            layer.run('scott');
                                        }
                                    }
                                
                                } else {
                                    console.log(`Layer not found : ${layerName}`);
                                }

                            });
                        */

                    });
                },false);
            })();
        </script>
    </body>
</html>